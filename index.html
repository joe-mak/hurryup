<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HurryUp - Daily Report Generator</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;700&family=Google+Sans+Text:wght@400;500;600;700&display=swap"
        rel="stylesheet">

    <link rel="stylesheet" href="style.css">
    <!-- Quill CSS -->
    <link href="https://cdn.quilljs.com/1.3.7/quill.snow.css" rel="stylesheet">

</head>

<body>
    <!-- Onboarding Page -->
    <div class="onboarding-page" id="onboardingPage">
        <div class="onboarding-container">
            <div class="onboarding-header">
                <div class="logo">
                    <div class="logo-icon"></div>
                    <span class="logo-text">HurryUp</span>
                </div>
                <p class="onboarding-subtitle">ตั้งค่าข้อมูลของคุณเพื่อเริ่มต้นใช้งาน</p>
            </div>

            <!-- Step Indicator -->
            <div class="step-indicator">
                <div class="step active" data-step="1">
                    <div class="step-number">1</div>
                    <span class="step-label">ข้อมูลส่วนตัว</span>
                </div>
                <div class="step-line"></div>
                <div class="step" data-step="2">
                    <div class="step-number">2</div>
                    <span class="step-label">โครงการ Taiga</span>
                </div>
                <div class="step-line"></div>
                <div class="step" data-step="3">
                    <div class="step-number">3</div>
                    <span class="step-label">เสร็จสิ้น</span>
                </div>
            </div>

            <!-- Step 1: Personal Info -->
            <div class="onboarding-step active" id="step1">
                <h2 class="step-title">ข้อมูลส่วนตัว</h2>
                <p class="step-description">กรอกข้อมูลพื้นฐานของคุณ</p>

                <div class="profile-upload">
                    <div class="profile-preview" id="profilePreview">
                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="#999" stroke-width="1.5">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                            <circle cx="12" cy="7" r="4"></circle>
                        </svg>
                    </div>
                    <div class="profile-upload-info">
                        <label class="upload-btn" for="profileImageInput">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="17 8 12 3 7 8"></polyline>
                                <line x1="12" y1="3" x2="12" y2="15"></line>
                            </svg>
                            อัปโหลดรูปโปรไฟล์
                        </label>
                        <input type="file" id="profileImageInput" accept="image/*" onchange="handleProfileImage(event)"
                            style="display:none;">
                        <p class="upload-hint">รองรับ JPG, PNG ขนาดไม่เกิน 2MB</p>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">ชื่อ-นามสกุล <span class="required">*</span></label>
                    <input type="text" class="form-input" id="onboardingName" placeholder="เช่น สมชาย ใจดี">
                </div>

                <div class="form-group">
                    <label class="form-label">ตำแหน่ง <span class="required">*</span></label>
                    <input type="text" class="form-input" id="onboardingRole"
                        placeholder="เช่น เจ้าหน้าที่พัฒนาโปรแกรม">
                </div>

                <div class="form-group">
                    <label class="form-label">สถานที่ปฏิบัติงาน <span class="required">*</span></label>
                    <input type="text" class="form-input" id="onboardingWorkplace" placeholder="เช่น บริษัท">
                </div>

                <div class="form-group">
                    <label class="form-label">ชื่อโครงการ (แสดงในบล็อก) <span class="required">*</span></label>
                    <input type="text" class="form-input" id="onboardingProjectLabel"
                        placeholder="เช่น รายงานการทำงานประจำวัน เข้า Office (ฝ่ายพัฒนาระบบ)">
                    <p class="form-hint">ข้อความนี้จะแสดงในหัวข้อ "โครงการ:" ของรายงาน</p>
                </div>

                <div class="onboarding-actions">
                    <div></div>
                    <button class="btn-primary" onclick="goToStep(2)">
                        ถัดไป
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                            <polyline points="12 5 19 12 12 19"></polyline>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Step 2: Projects -->
            <div class="onboarding-step" id="step2">
                <h2 class="step-title">เพิ่มโครงการ Taiga</h2>
                <p class="step-description">เพิ่ม Taiga URL สำหรับโครงการที่คุณทำงาน (สามารถเพิ่มเติมภายหลังได้)</p>

                <div class="projects-list" id="onboardingProjectsList"></div>

                <div class="add-project-form">
                    <div class="form-row">
                        <div class="form-group" style="flex: 1;">
                            <label class="form-label">ชื่อโครงการ</label>
                            <input type="text" class="form-input" id="onboardingProjectName"
                                placeholder="เช่น BMS DesignKit">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Taiga URL</label>
                        <input type="text" class="form-input" id="onboardingProjectUrl"
                            placeholder="https://taiga.hosxp.net/project/...">
                    </div>
                    <button class="btn-add-project" onclick="addOnboardingProject()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                        เพิ่มโครงการ
                    </button>
                </div>

                <div class="onboarding-actions">
                    <button class="btn-secondary" onclick="goToStep(1)">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <line x1="19" y1="12" x2="5" y2="12"></line>
                            <polyline points="12 19 5 12 12 5"></polyline>
                        </svg>
                        ย้อนกลับ
                    </button>
                    <button class="btn-primary" onclick="goToStep(3)">
                        ถัดไป
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                            <polyline points="12 5 19 12 12 19"></polyline>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Step 3: Complete -->
            <div class="onboarding-step" id="step3">
                <div class="complete-icon">
                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="#194987" stroke-width="2">
                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                        <polyline points="22 4 12 14.01 9 11.01"></polyline>
                    </svg>
                </div>
                <h2 class="step-title" style="text-align: center;">พร้อมใช้งานแล้ว!</h2>
                <p class="step-description" style="text-align: center;">ข้อมูลของคุณถูกบันทึกเรียบร้อยแล้ว</p>

                <div class="summary-card">
                    <div class="summary-profile">
                        <div class="summary-avatar" id="summaryAvatar">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#999"
                                stroke-width="1.5">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                <circle cx="12" cy="7" r="4"></circle>
                            </svg>
                        </div>
                        <div class="summary-info">
                            <div class="summary-name" id="summaryName">-</div>
                            <div class="summary-role" id="summaryRole">-</div>
                            <div class="summary-workplace" id="summaryWorkplace">-</div>
                        </div>
                    </div>
                    <div class="summary-projects">
                        <div class="summary-projects-label">โครงการ Taiga ที่เพิ่ม</div>
                        <div class="summary-projects-count" id="summaryProjectsCount">0 โครงการ</div>
                    </div>
                </div>

                <div class="onboarding-actions" style="justify-content: center;">
                    <button class="btn-primary btn-large" onclick="completeOnboarding()">
                        เริ่มใช้งาน
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                            <polyline points="12 5 19 12 12 19"></polyline>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
    </div>

    <!-- Main App (hidden until onboarding complete) -->
    <div class="main-app" id="mainApp" style="display: none;">

        <!-- Sticky Header Wrapper -->
        <div class="header-wrapper" id="headerWrapper">
            <header class="header">
                <div class="logo">
                    <div class="logo-icon"></div>
                    <span class="logo-text">HurryUp</span>
                </div>
                <button class="settings-btn" onclick="openSettings()">
                    จัดการข้อมูล
                    <svg class="settings-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3"></circle>
                        <path
                            d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                        </path>
                    </svg>
                </button>
            </header>
        </div>

        <div class="input-section" id="inputSection">
            <!-- Hero Section - Full Width Banner -->
            <section class="hero-section">
                <section class="greeting-section">
                    <p class="date-time" id="dateTime"></p>
                    <h1 class="greeting" id="greeting"></h1>
                    <p class="role" id="userRole"></p>
                </section>
            </section>

            <div class="container">
                <section class="stats-grid">
                    <div class="stat-card">
                        <p class="stat-label">โครงการทั้งหมด</p>
                        <p class="stat-value" id="totalProjects">0</p>
                        <div class="stat-illustration stat-illustration-1"></div>
                    </div>
                    <div class="stat-card">
                        <p class="stat-label">รายงานแล้วในปีนี้ (ครั้ง)</p>
                        <p class="stat-value" id="totalReports">0</p>
                        <div class="stat-illustration stat-illustration-2"></div>
                    </div>
                    <div class="stat-card">
                        <p class="stat-label">การอัปบล็อกวันนี้</p>
                        <p class="stat-value thai" id="todayStatus">ยัง</p>
                        <div class="stat-illustration stat-illustration-3"></div>
                    </div>
                </section>

                <!-- Heatmap Calendar Section -->
                <section class="heatmap-card">
                    <div class="heatmap-header">
                        <h3 class="heatmap-title">ปฏิทินการอัปบล็อก</h3>
                        <div class="heatmap-legend">
                            <span class="legend-label">น้อย</span>
                            <div class="legend-scale">
                                <div class="legend-box level-0"></div>
                                <div class="legend-box level-1"></div>
                                <div class="legend-box level-2"></div>
                                <div class="legend-box level-3"></div>
                            </div>
                            <span class="legend-label">มาก</span>
                        </div>
                    </div>
                    <div class="heatmap-container">
                        <div class="heatmap-months" id="heatmapMonths"></div>
                        <div class="heatmap-wrapper">
                            <div class="heatmap-days">
                                <span>อา.</span>
                                <span>จ.</span>
                                <span>อ.</span>
                                <span>พ.</span>
                                <span>พฤ.</span>
                                <span>ศ.</span>
                                <span>ส.</span>
                            </div>
                            <div class="heatmap-grid" id="heatmapGrid"></div>
                        </div>
                    </div>
                </section>
                <section class="morning-template-section">
                    <div class="morning-template-bg"></div>
                    <div class="morning-template-content">
                        <h3 class="morning-template-title">เอาล่ะ วันนี้จะทำอะไรดี</h3>
                        <p class="morning-template-subtitle">คัดลอกเทมเพลตรายงานประจำวันตอนเช้า (สำหรับฝ่ายพัฒนา)</p>
                    </div>
                    <div class="morning-template-actions">
                        <button class="edit-template-btn" onclick="openMorningTemplateModal()">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                            </svg>
                            <span>แก้ไข</span>
                        </button>
                        <button class="copy-btn-float morning-copy-btn" onclick="copyMorningTemplate(this)">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                            </svg>
                            <span class="copy-text">คัดลอก</span>
                        </button>
                    </div>
                </section>


                <section class="main-card">
                    <h2 class="card-title">วันนี้คุณทำอะไรไปแล้วบ้าง ?</h2>
                    <p class="card-subtitle">เลือกโครงการที่ทำในวันนี้
                        จากนั้นเพิ่มรายละเอียดงานที่ทำได้ในเทมเพลตด้านล่าง</p>



                    <div class="section-label">
                        เลือกโครงการที่ทำ
                        
                    </div>
                    <div class="project-chips" id="projectChips"></div>

                    <div class="tasks-section">
                        <p class="section-label">เพิ่มรายละเอียดในเทมเพลต</p>
                        <div id="tasksEditorContainer" style="display:none;">
                            <div id="tasksEditor"></div>
                        </div>
                        <!-- Fallback textarea if Quill fails to load -->
                        <textarea id="tasksTextareaFallback" class="tasks-textarea"
                            placeholder="เทมเพลตจะปรากฏเมื่อเลือกโครงการ..."></textarea>
                        
                        <!-- Image Attachment Section -->
                        <div class="task-image-section">
                            <p class="section-label">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                    <circle cx="8.5" cy="8.5" r="1.5"></circle>
                                    <polyline points="21 15 16 10 5 21"></polyline>
                                </svg>
                                แนบรูปภาพ (ไม่บังคับ)
                            </p>
                            <div class="image-gallery" id="taskImageGallery"></div>
                            <div class="image-paste-area" id="taskImagePasteArea">
                                <div class="image-paste-placeholder" id="taskImagePlaceholder">
                                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#999" stroke-width="1.5">
                                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                        <circle cx="8.5" cy="8.5" r="1.5"></circle>
                                        <polyline points="21 15 16 10 5 21"></polyline>
                                    </svg>
                                    <p>คลิกเพื่อเลือกรูป หรือ วางรูปภาพที่นี่ (Ctrl+V)</p>
                                    <p class="image-paste-hint">รองรับ JPG, PNG ขนาดไม่เกิน 2MB ต่อรูป (เพิ่มได้หลายรูป)</p>
                                </div>
                            </div>
                            <input type="file" id="taskImageInput" accept="image/*" multiple onchange="handleTaskImageSelect(event)" style="display: none;">
                        </div>
                    </div>

                    <button class="submit-btn" id="submitBtn" onclick="generateSummary()" disabled>
                        สรุปผลของวันนี้
                        <svg class="check-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="20 6 9 17 4 12"></polyline>
                        </svg>
                    </button>
                </section>
            </div>
        </div>
        <!-- End input-section -->

        <div class="summary-section" id="summarySection">
            <div class="container">
                <button class="back-btn" onclick="goBack()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="19" y1="12" x2="5" y2="12"></line>
                        <polyline points="12 19 5 12 12 5"></polyline>
                    </svg>
                    กลับไปแก้ไข
                </button>

                <!-- Blog Preview Card -->
                <div class="blog-preview-card">
                    <div class="blog-header">
                        <div class="blog-avatar" id="blogAvatar"></div>
                        <div class="blog-header-info">
                            <div class="blog-author" id="blogAuthor"></div>
                            <div class="blog-meta" id="blogMeta"></div>
                            <div class="blog-project" id="blogProject"></div>
                        </div>
                    </div>

                    <div class="blog-content-wrapper">
                        <button class="copy-btn-float" onclick="copyBlogContent(this)" title="คัดลอกข้อความ">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                            </svg>
                            <span class="copy-text">คัดลอก</span>
                        </button>
                        <div class="blog-content" id="blogContent"></div>
                        
                        <!-- Attached Images Gallery -->
                        <div class="blog-image-gallery" id="blogImageGallery" style="display: none;"></div>
                    </div>
                </div>

                <!-- Taiga URLs Section -->
                <div class="taiga-section">
                    <h3 class="taiga-section-title">โครงการ Taiga</h3>
                    <div class="taiga-urls-list" id="taigaOutput"></div>
                </div>

                <div style="text-align: center; margin-top: 32px; margin-bottom: 32px;">
                    <button class="btn-primary" onclick="markAsDone()" style="padding: 14px 32px; border-radius: 32px;">
                        ✓ บันทึกว่าอัปบล็อกแล้ววันนี้
                    </button>
                </div>
            </div>
        </div>
        <!-- End summary-section -->

        <footer class="footer">
            <div class="footer-logo"></div>
            <span>HurryUp</span>
        </footer>

    </div>
    <!-- End Main App -->

    <div class="modal-overlay" id="settingsModal">
        <div class="modal modal-settings">
            <div class="modal-header">
                <h3 class="modal-title">จัดการข้อมูล</h3>
                <button class="modal-close" onclick="closeSettings()">&times;</button>
            </div>

            <div class="settings-layout">
                <!-- Sidebar Navigation -->
                <div class="settings-sidebar">
                    <button class="settings-nav-item active" data-tab="personal" onclick="switchSettingsTab('personal')">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                            <circle cx="12" cy="7" r="4"></circle>
                        </svg>
                        <span>ข้อมูลส่วนตัว</span>
                    </button>
                    <button class="settings-nav-item" data-tab="projects" onclick="switchSettingsTab('projects')">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
                        </svg>
                        <span>จัดการโครงการ</span>
                    </button>
                </div>

                <!-- Content Area -->
                <div class="settings-content">
                    <!-- Personal Info Tab -->
                    <div class="settings-tab active" id="tabPersonal">
                        <div class="profile-upload" style="margin-bottom: 20px;">
                            <div class="profile-preview" id="settingsProfilePreview">
                                <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="#999" stroke-width="1.5">
                                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                    <circle cx="12" cy="7" r="4"></circle>
                                </svg>
                            </div>
                            <div class="profile-upload-info">
                                <label class="upload-btn" for="settingsProfileImageInput">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                        <polyline points="17 8 12 3 7 8"></polyline>
                                        <line x1="12" y1="3" x2="12" y2="15"></line>
                                    </svg>
                                    เปลี่ยนรูปโปรไฟล์
                                </label>
                                <input type="file" id="settingsProfileImageInput" accept="image/*"
                                    onchange="handleSettingsProfileImage(event)" style="display:none;">
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">ชื่อ-นามสกุล</label>
                            <input type="text" class="form-input" id="settingsUserName" placeholder="เช่น ภัทรพล">
                        </div>
                        <div class="form-group">
                            <label class="form-label">ตำแหน่ง</label>
                            <input type="text" class="form-input" id="settingsUserRole"
                                placeholder="เช่น เจ้าหน้าที่ออกแบบแอปพลิเคชัน">
                        </div>
                        <div class="form-group">
                            <label class="form-label">สถานที่ปฏิบัติงาน</label>
                            <input type="text" class="form-input" id="settingsWorkplace" placeholder="เช่น ศูนย์เทคโนโลยีสารสนเทศ">
                        </div>
                        <div class="form-group">
                            <label class="form-label">ชื่อโครงการ (แสดงในบล็อก)</label>
                            <input type="text" class="form-input" id="settingsProjectLabel"
                                placeholder="เช่น รายงานการทำงานประจำวัน เข้า Office (ฝ่ายพัฒนาระบบ)">
                        </div>

                        <div class="settings-divider"></div>

                        <!-- Export Data Section -->
                        <div class="export-zone">
                            <div class="settings-section-title">ส่งออกข้อมูล</div>
                            <p class="export-zone-description">ดาวน์โหลดข้อมูลทั้งหมดของคุณเป็นไฟล์ JSON รวมถึงโปรไฟล์ โครงการ และประวัติการรายงาน</p>
                            <button class="btn-export" onclick="exportData()">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                    <polyline points="7 10 12 15 17 10"></polyline>
                                    <line x1="12" y1="15" x2="12" y2="3"></line>
                                </svg>
                                ส่งออกข้อมูล
                            </button>
                        </div>

                        <div class="settings-divider"></div>

                        <div class="danger-zone">
                            <div class="settings-section-title" style="color: #c00;">ลบข้อมูลทั้งหมด</div>
                            <p class="danger-zone-description">การดำเนินการนี้จะลบข้อมูลทั้งหมดของคุณ รวมถึงโปรไฟล์ โครงการ
                                และประวัติการรายงาน และไม่สามารถกู้คืนได้</p>
                            <button class="btn-delete-all" onclick="confirmDeleteAllData()">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="3 6 5 6 21 6"></polyline>
                                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                    <line x1="10" y1="11" x2="10" y2="17"></line>
                                    <line x1="14" y1="11" x2="14" y2="17"></line>
                                </svg>
                                ลบข้อมูลทั้งหมด
                            </button>
                        </div>
                    </div>

                    <!-- Projects Tab -->
                    <div class="settings-tab" id="tabProjects">
                        <div class="project-list" id="projectList"></div>

                        <h4 style="font-size: 14px; margin-bottom: 12px;" id="projectFormTitle">เพิ่มโครงการใหม่</h4>
                        <div class="form-group">
                            <label class="form-label">ชื่อโครงการ</label>
                            <input type="text" class="form-input" id="newProjectName" placeholder="เช่น BMS DesignKit">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Taiga URL</label>
                            <input type="text" class="form-input" id="newProjectUrl"
                                placeholder="https://taiga.example.com/project/...">
                        </div>
                        <div class="form-group">
                            <label class="form-label">เทมเพลตรายงาน</label>
                            <div id="templateEditorContainer" style="display:none;">
                                <div id="templateEditor"></div>
                            </div>
                            <!-- Fallback textarea if Quill fails to load -->
                            <textarea id="templateTextareaFallback" class="form-textarea"
                                placeholder="โครงการ: {project} ประกอบไปด้วยผลการดำเนินงาน ดังนี้&#10;1. &#10;2. &#10;3."></textarea>
                            <p class="form-hint">ใช้ <code
                                    style="background: #e5edf5; padding: 2px 6px; border-radius: 3px; color: #194987;">{project}</code>
                                แทนชื่อโครงการ</p>
                        </div>
                        <div class="btn-group">
                            <button class="btn-secondary" onclick="cancelEditProject()" id="cancelEditBtn"
                                style="display: none;">ยกเลิก</button>
                            <button class="btn-primary" onclick="saveProject()" id="saveProjectBtn">เพิ่มโครงการ</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn-primary" onclick="saveCurrentTab()">บันทึก</button>
            </div>
        </div>
    </div>

    <!-- Morning Template Modal -->
    <div class="modal-overlay" id="morningTemplateModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">แก้ไขเทมเพลตรายงานตอนเช้า</h3>
                <button class="modal-close" onclick="closeMorningTemplateModal()">&times;</button>
            </div>

            <div class="form-group">
                <label class="form-label">รูปแบบเทมเพลต</label>
                <textarea id="morningTemplateText" class="form-textarea" rows="6"
                    placeholder="{name}&#10;งานประจำวันที่ {date}&#10;- "></textarea>
                <p class="form-hint">ตัวแปรที่ใช้ได้:</p>
                <div class="template-variables">
                    <span class="variable-tag" onclick="insertVariable('name')">{name}</span>
                    <span class="variable-hint">ชื่อ-นามสกุล</span>
                    <span class="variable-tag" onclick="insertVariable('date')">{date}</span>
                    <span class="variable-hint">วันที่ปัจจุบัน</span>
                    <span class="variable-tag" onclick="insertVariable('role')">{role}</span>
                    <span class="variable-hint">ตำแหน่ง</span>
                    <span class="variable-tag" onclick="insertVariable('workplace')">{workplace}</span>
                    <span class="variable-hint">สถานที่ปฏิบัติงาน</span>
                </div>
            </div>

            <div class="template-preview-section">
                <label class="form-label">ตัวอย่างผลลัพธ์</label>
                <div class="template-preview-box" id="morningTemplatePreview"></div>
            </div>

            <div class="btn-group">
                <button class="btn-secondary" onclick="resetMorningTemplate()">รีเซ็ตเป็นค่าเริ่มต้น</button>
                <button class="btn-primary" onclick="saveMorningTemplate()">บันทึก</button>
            </div>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <!-- Quill JS -->
    <script src="https://cdn.quilljs.com/1.3.7/quill.min.js"></script>

    <script src="app.js"></script>

    <script>
        const DEFAULT_TEMPLATE = `<p>โครงการ: {project} ประกอบไปด้วยผลการดำเนินงาน ดังนี้</p><ol><li><br></li><li><br></li><li><br></li></ol>`;


    </script>
</body>

</html>